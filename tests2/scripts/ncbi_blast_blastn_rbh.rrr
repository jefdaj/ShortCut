# TODO why so few hits when using NA sequences?

pcc6803 = load_fna "data/Mycoplasma_genitalium_M2321_10genes.fna"
pcc7942 = load_fna "data/Mycoplasma_genitalium_M2321_10genes.fna"

n = 1e-5
fwd = blastn n pcc6803 pcc7942

# can do the reverse blast manually by flipping args, or use _rev
rev1 = blastn     n pcc7942 pcc6803
rev2 = blastn_rev n pcc6803 pcc7942

rbh1 = reciprocal_best fwd rev1
rbh2 = reciprocal_best fwd rev2

# or, can do the entire thing with _rbh
rbh3 = blastn_rbh n pcc6803 pcc7942

# finally, doing it all in reverse should come out the same too
# (but have to extract target IDs now)
rbh4 = blastn_rbh n pcc7942 pcc6803

# test that all 4 methods give the same results
# (and also manually check that they share tmpfiles)
lists = extract_queries_each [rbh1, rbh2, rbh3]
      | extract_targets_each [rbh4]
result = any lists ~ all lists
