# Train a pssm per gene against a list of genomes, search them all against one
# genome, and return a list of hit tables. Depending on your specific purpose
# you might want priblast_pssms_all, which returns one big table.

queries    = split_faa (load_faa "data/7942genes10.faa")
pcc6803    = load_faa "data/6803genes.faa"
pcc7942    = load_faa "data/7942genes.faa"
cyanodb    = makeblastdb_prot [pcc6803, pcc7942]
pssms      = psiblast_train_pssms_db 1e-10 queries cyanodb

# TODO write/rewrite:
tables6803 = psiblast_pssms          1e-10 pssms pcc6803

result     = tables6803
