# This tests that the *blast*_rev* functions work like their forward
# equivalents. They make writing reciprocal hits simpler: just paste the same
# line and add "_rev".

small = load_fna "data/7942genes10.fna"
large = load_fna "data/7942genes.fna"

# fwds and srevs have flipped args, so after _rev flips them again both should
# be equal. mrevs should also equal srevs, just wrapped in a list + unwrapped.
fwds  =      extract_queries      (blastn          1e-5 small  large )
srevs =      extract_queries      (blastn_rev      1e-5 large  small )
mrevs = any (extract_queries_each (blastn_rev_each 1e-5 large [small]))

# List hits in some but not all of the lists. Should be [].
# (Equivalent to any [fwds, srevs, mrevs] ~ all [fwds, srevs, mrevs])
result = some [fwds, srevs, mrevs]
