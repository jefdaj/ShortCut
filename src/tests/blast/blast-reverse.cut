# This tests the *blast*_rev functions. They aren't very useful on their own,
# but make it easier to write reciprocal best hits because you can write the
# reverse call by pasting the forward one and adding "_rev".

small = load_fna "data/7942genes10.fna"
large = load_fna "data/7942genes.fna"

# these have flipped args, so after _rev flips them again both should be equal
# TODO disallow attempting to do set operations on hits!
# fwds = blastn     small large 1e-5
# revs = blastn_rev large small 1e-5

fwds = extract_queries (blastn     small large 1e-5)
revs = extract_queries (blastn_rev large small 1e-5)

# shows difference between the sets; should be []
# (real test is that only one set of blast tmpfiles was created)
result = (fwds ~ revs) | (revs ~ fwds)
