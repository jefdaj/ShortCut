# This tests that BLAST on two lists only does one search per duplicate
# element. It mainly guards against bugs in naming the hashed tmpfiles.

# TODO what's this almost-infinite loop it's getting into?? writes lits for days yo

reference = load_faa "data/6803genes10.faa"

small = load_faa_all ["data/6803genes10.faa"]
large = load_faa_all ["data/7002genes.faa"] | small

# Only one BLAST search should be done against each of the genomes
# in "small" because the result should be reused in "large".
small_hits = extract_all_queries (crb_blast_all reference small)
large_hits = extract_all_queries (crb_blast_all reference large)

# Result isn't important; just need it to evaluate both lists.
# The real test is that it produces the expected tmpfiles.
result = any large_hits ~ any small_hits
