# Tests the *blast*_db functions, which are the basis of everything else.
# They're probably not the ones you want to call directly though, because they
# need an explicit makeblastdb call to make the db first.

# TODO test the results too, not just that it runs!

large6803faa = load_faa "data/6803genes.faa"
small6803faa = load_faa "data/6803genes10.faa"

large7942faa = load_faa "data/7942genes.faa"
large7942fna = load_fna "data/7942genes.fna"
small7942faa = load_faa "data/7942genes10.faa"
small7942fna = load_fna "data/7942genes10.fna"

hits6803p = blastp_db 1e-5 small6803faa (makeblastdb_prot large6803faa)
hits6803x = blastx_db 1e-5 small6803fna (makeblastdb_prot large6803faa)

hits7942n = blastn_db 1e-5 small7942fna (makeblastdb_nucl large7942fna)
hits7942p = blastp_db 1e-5 small7942faa (makeblastdb_prot large6803faa)
hits7942x = blastx_db 1e-5 small7942fna (makeblastdb_prot large6803faa)

# TODO add tblastn? (does that make sense?)
# TODO add tblastx? (does that make sense?)

result = any (extract_queries_each
  [ hits6803n, hits6803p, hits6803x
  , hits7942n, hits7942p, hits7942x ])
