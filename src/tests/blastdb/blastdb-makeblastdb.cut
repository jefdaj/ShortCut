# Tests the *blast*_db functions, which are the basis of everything else.
# They're probably not the ones you want to call directly though, because they
# need an explicit makeblastdb call to make the db first.

# TODO test the results too, not just that it runs!
# TODO why does hits6803n not have any results??
# TODO download the 6803 genbank to get fna genes

# large6803fna = load_fna "data/6803genes.fna"
large7942fna = load_fna "data/7942genes.fna"

large6803faa = load_faa "data/6803genes.faa"
large7942faa = load_faa "data/7942genes.faa"

small6803faa = load_faa "data/6803genes10.faa"
small7942faa = load_faa "data/7942genes10.faa"

small6803fna = load_fna "data/6803genes10.fna"
small7942fna = load_fna "data/7942genes10.fna"

hits6803n = blastn_db small6803fna (makeblastdb_nucl large7942fna) 1e-5
hits7942n = blastn_db small7942fna (makeblastdb_nucl large7942fna) 1e-5

hits6803p = blastp_db small6803faa (makeblastdb_prot large7942faa) 1e-5
hits7942p = blastp_db small7942faa (makeblastdb_prot large6803faa) 1e-5

hits6803x = blastx_db small6803fna (makeblastdb_prot large7942faa) 1e-5
hits7942x = blastx_db small7942fna (makeblastdb_prot large6803faa) 1e-5

# TODO add tblastn? (does that make sense?)
# TODO add tblastx? (does that make sense?)

result = extract_queries_each
  [ hits6803n, hits7942n
  , hits6803p, hits7942p
  , hits6803x, hits7942x
  ]
