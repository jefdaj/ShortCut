mgen = load_faa "examples/sequences/Mycoplasma_genitalium_protein_refseq.faa"
maga = load_faa "examples/sequences/Mycoplasma_agalactiae_small.faa"
n = 1.0e-5
fwd = blastp_db n mgen (makeblastdb_prot_all [maga])
rev1 = blastp_db n maga (makeblastdb_prot_all [mgen])
rev2 = blastp_db n maga (makeblastdb_prot mgen)
rbh1 = reciprocal_best fwd rev1
rbh2 = reciprocal_best fwd rev2
rbh3 = reciprocal_best (blastp_db n mgen (makeblastdb_prot_all [maga]))
                       (blastp_db n maga (makeblastdb_prot mgen))
rbh4 = reciprocal_best (blastp_db n maga (makeblastdb_prot_all [mgen]))
                       (blastp_db n mgen (makeblastdb_prot maga))
lists = extract_queries_each [rbh1, rbh2, rbh3] | (extract_targets_each [rbh4])
result = any lists ~ (all lists)