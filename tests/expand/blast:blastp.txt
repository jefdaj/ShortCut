maga = load_faa "examples/sequences/Mycoplasma_agalactiae_protein_refseq.faa"
mgen = load_faa "examples/sequences/Mycoplasma_genitalium_protein_refseq.faa"
single = extract_queries (blastp_db 1.0e-5 maga (makeblastdb_prot_all [mgen]))
mapped = extract_queries_each (blastp_db_each 1.0e-5
                                              maga
                                              (makeblastdb_prot_all_each (singletons [mgen])))
result = length_each ([single] | mapped)