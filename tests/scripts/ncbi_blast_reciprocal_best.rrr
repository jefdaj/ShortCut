# TODO what's up with this?? nondeterministic despite repeats

maga = load_faa "data/Mycoplasma_agalactiae_PG2_protein_refseq.faa"
mgen = load_faa "data/Mycoplasma_genitalium_protein_refseq.faa"

fwdHits = blastp 1e-5 maga mgen
revHits = blastp 1e-5 mgen maga

bestFwd = best_hits fwdHits
bestRec = reciprocal_best fwdHits revHits

# results vary a lot; repeat 20X to be sure
best20fwd = repeat bestFwd mgen 20
best20rec = repeat bestRec mgen 20

solidFwd = all (extract_queries_each best20fwd)
solidRec = all (extract_queries_each best20rec)

# reciprocal_best should produce a subset of the original forward hits and
# nothing new, giving [some number, 0].
# result = length_each [solidFwd ~ solidRec,
                      #solidRec ~ solidFwd]
result = solidRec
