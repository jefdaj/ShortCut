maga = load_faa "data/Mycoplasma_agalactiae_protein_refseq.faa"
mgen = load_faa "data/Mycoplasma_genitalium_protein_refseq.faa"

mgendb = makeblastdb_prot mgen

single   = extract_queries      (blastp      1e-5 maga  mgen )
mapped   = extract_queries_each (blastp_each 1e-5 maga [mgen])
singledb = extract_queries      (blastp_db      1e-5 maga  mgendb )
mappeddb = extract_queries_each (blastp_db_each 1e-5 maga [mgendb])

# should be [350] (all fn calls give the same 350 results)
# TODO why are two blastp_db calls made?
result = length_each ([single] | mapped | [singledb] | mappeddb)
