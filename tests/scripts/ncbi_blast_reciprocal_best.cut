# TODO what's up with this?? nondeterministic despite repeats

# TODO stop the error where it returns an empty list, that can't be right!

maga = load_faa "data/Mycoplasma_agalactiae_PG2_protein_refseq.faa"
mgen = load_faa "data/Mycoplasma_genitalium_protein_refseq.faa"

fwdHits = blastp 1e-5 maga mgen
revHits = blastp 1e-5 mgen maga

bestFwd = best_hits fwdHits
bestRec = reciprocal_best fwdHits revHits

# results vary a lot; repeat 5X to be sure
best5fwd = repeat bestFwd mgen 5
best5rec = repeat bestRec mgen 5

solidFwd = all (extract_queries_each best5fwd)
solidRec = all (extract_queries_each best5rec)

# reciprocal_best should produce a subset of the original forward hits and
nothing new, giving [some number, 0].
result = length_each [solidFwd ~ solidRec,
                      #solidRec ~ solidFwd]
result = length solidRec
